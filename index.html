<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ACR-Soul - Kullanıcı Görüntüleyici</title>
  <style>
    :root{
      --bg:#0f1724; /* koyu arka */
      --card:#0b1220;
      --accent:#e11d48; /* kırmızı-pembe ton */
      --muted:#98a2b3;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#071024 0%, #0a1326 100%);
      color:#e6eef8;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
    }

    .container{
      width:100%;
      max-width:880px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      padding:28px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
      border: 1px solid rgba(255,255,255,0.03);
    }

    header{
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:20px;
    }

    .logo{
      width:64px;
      height:64px;
      border-radius:10px;
      display:grid;
      place-items:center;
      font-weight:700;
      font-size:18px;
      background:linear-gradient(135deg,var(--accent), #a71b3d);
      box-shadow: 0 6px 18px rgba(167,27,61,0.18);
    }

    h1{
      margin:0;
      font-size:28px;
      letter-spacing:1px;
    }
    p.lead{ margin:6px 0 0; color:var(--muted); font-size:13px }

    .controls{
      display:flex;
      gap:12px;
      margin-top:18px;
      align-items:flex-end;
      flex-wrap:wrap;
    }
    label{ font-size:13px; color:var(--muted); display:block; margin-bottom:6px }
    .field{
      background:var(--glass);
      border-radius:10px;
      padding:12px;
      min-width:220px;
      display:flex;
      flex-direction:column;
    }
    input[type="text"], input[type="url"], select {
      background:transparent;
      border:0;
      outline:0;
      color:inherit;
      font-size:15px;
      width:100%;
    }

    .btn{
      background:linear-gradient(90deg,var(--accent), #b92a4c);
      border:0;
      color:white;
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      box-shadow: 0 6px 16px rgba(167,27,61,0.18);
    }
    .btn.secondary{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--muted);
      box-shadow:none;
    }

    .preview{
      margin-top:22px;
      display:flex;
      gap:18px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-start;
    }

    .head-card{
      width:130px;
      min-width:130px;
      background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:12px;
      text-align:center;
      border:1px solid rgba(255,255,255,0.03);
      transition:transform .16s ease, box-shadow .16s ease;
    }
    .head-card:hover{ transform:translateY(-6px); box-shadow: 0 18px 40px rgba(2,6,23,0.5) }

    .head{
      width:96px;
      height:96px;
      border-radius:10px;
      margin:0 auto 10px;
      background:#071022;
      display:block;
      object-fit:cover;
      border:1px solid rgba(255,255,255,0.04);
      cursor:pointer;
    }

    .username{
      font-weight:700;
      font-size:14px;
      margin-bottom:4px;
    }
    .meta{ font-size:12px; color:var(--muted) }

    .hint{ margin-top:12px; color:var(--muted); font-size:13px }

    /* responsive */
    @media (max-width:560px){
      .controls{ flex-direction:column; align-items:stretch }
      .field{ min-width:unset; width:100% }
    }
  </style>
</head>
<body>
  <div class="container" role="main">
    <header>
      <div class="logo">ACR<br/>Soul</div>
      <div>
        <h1>ACR-Soul</h1>
        <p class="lead">Kullanıcı adı gir → oyuncu kafası görünür → kafaya tıklayınca istediğiniz siteye yönlendirir.</p>
      </div>
    </header>

    <form id="form" autocomplete="off" onsubmit="return false;">
      <div class="controls">
        <div class="field" style="flex:1; min-width:240px;">
          <label for="username">Kullanıcı adı (Minecraft)</label>
          <input id="username" type="text" placeholder="Örnek: Notch veya acroz" />
        </div>

        <div class="field" style="min-width:260px;">
          <label for="target">Yönlendirme URL'si (tıklanınca açılacak site)</label>
          <input id="target" type="url" placeholder="https://example.com veya boşsa yeni sekme açılmayacak" />
        </div>

        <div style="display:flex;gap:8px;align-items:center">
          <div class="field" style="width:120px;">
            <label for="size">Boyut (px)</label>
            <select id="size" aria-label="avatar size">
              <option value="64">64</option>
              <option value="96" selected>96</option>
              <option value="128">128</option>
              <option value="200">200</option>
            </select>
          </div>

          <div style="display:flex;flex-direction:column;gap:8px;">
            <button class="btn" id="showBtn">Göster</button>
            <button class="btn secondary" id="clearBtn" type="button">Temizle</button>
          </div>
        </div>
      </div>
    </form>

    <div class="preview" id="preview" aria-live="polite">
      <!-- Dinamik olarak avatarlar buraya gelecek -->
    </div>

    <p class="hint">Not: Bu sayfa doğrudan Minecraft sunucusundan veri çekmez. Ortak kullanımlı avatar servisi (public avatar API) kullanılır — kullanıcı adını girince genel avatar görüntüsü getirilir.</p>
  </div>

  <script>
    (function(){
      const usernameInput = document.getElementById('username');
      const targetInput = document.getElementById('target');
      const sizeSelect = document.getElementById('size');
      const showBtn = document.getElementById('showBtn');
      const clearBtn = document.getElementById('clearBtn');
      const preview = document.getElementById('preview');

      // Kullanıcıdan gelen URL güvenliği: basit kontrol (javascript yönlendirme / boşluk)
      function cleanUrl(u){
        if(!u) return '';
        try{
          const url = new URL(u);
          return url.toString();
        }catch(e){
          // eğer protokolsüz yazıldıysa http ekle
          try {
            const url2 = new URL('https://' + u);
            return url2.toString();
          } catch(e2){
            return ''; // geçersizse boş döndür
          }
        }
      }

      // Avatar servisleri (username ile çalışır): minotar ve mc-heads
      function avatarUrl(username, size){
        username = encodeURIComponent(username);
        // minotar: https://minotar.net/avatar/<username>/<size>.png
        return `https://minotar.net/avatar/${username}/${size}.png`;
        // Alternatifler: https://crafatar.com/avatars/<uuid>?size=<size>  (uuid gerek) 
      }

      function createHeadCard(username, avatarSrc, targetUrl){
        const card = document.createElement('div');
        card.className = 'head-card';

        const img = document.createElement('img');
        img.className = 'head';
        img.alt = username + ' avatar';
        img.src = avatarSrc;
        img.loading = 'lazy';

        // tıklama: hedef url varsa yeni pencerede aç, yoksa hiçbir şey yapma
        img.addEventListener('click', (e) => {
          if(targetUrl){
            // açılacak pencereyi güvenli şekilde aç
            window.open(targetUrl, '_blank', 'noopener,noreferrer');
          } else {
            // eğer hedef yoksa görseli büyüt
            const w = window.open('', '_blank');
            w.document.write(`<title>${username} - avatar</title><img src="${avatarSrc}" style="display:block;margin:30px auto;max-width:96%;height:auto;border-radius:8px">`);
          }
        });

        const nameEl = document.createElement('div');
        nameEl.className = 'username';
        nameEl.textContent = username;

        const meta = document.createElement('div');
        meta.className = 'meta';
        meta.textContent = targetUrl ? ('Tıkla → ' + targetUrl) : 'Tıklayınca yeni sekme açılır.';

        card.appendChild(img);
        card.appendChild(nameEl);
        card.appendChild(meta);
        return card;
      }

      function showAvatar(){
        const username = usernameInput.value.trim();
        if(!username){
          alert('Lütfen bir kullanıcı adı girin.');
          usernameInput.focus();
          return;
        }
        const size = parseInt(sizeSelect.value) || 96;
        const rawTarget = targetInput.value.trim();
        const target = cleanUrl(rawTarget);

        const avatar = avatarUrl(username, size);

        // Eğer aynı kullanıcı zaten listede varsa onu güncelle
        // (aynı isim + hedefle eşleşmiyorsa yeni bir kart eklenir)
        const existing = Array.from(preview.querySelectorAll('.head-card .username'))
                              .find(el => el.textContent.toLowerCase() === username.toLowerCase());
        if(existing){
          // mevcut kartı sil ve yenisini ekle başa
          existing.parentElement.remove();
        }

        const card = createHeadCard(username, avatar, target);
        // başa ekle
        preview.insertBefore(card, preview.firstChild);
      }

      // eventler
      showBtn.addEventListener('click', showAvatar);
      clearBtn.addEventListener('click', () => {
        usernameInput.value = '';
        targetInput.value = '';
        preview.innerHTML = '';
        usernameInput.focus();
      });

      // Enter ile submit
      usernameInput.addEventListener('keydown', (e) => {
        if(e.key === 'Enter') { e.preventDefault(); showAvatar(); }
      });
      targetInput.addEventListener('keydown', (e) => {
        if(e.key === 'Enter') { e.preventDefault(); showAvatar(); }
      });

      // örnek hızlı kullanım: doubleclick boş alan -> örnek doldur
      document.addEventListener('dblclick', (e) => {
        if(document.activeElement === document.body){
          usernameInput.value = 'Notch';
          targetInput.value = 'https://www.minecraft.net';
        }
      });

    })();
  </script>
</body>
</html>

